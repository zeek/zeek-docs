:tocdepth: 3

base/protocols/ftp/utils-commands.bro
=====================================
.. bro:namespace:: FTP


:Namespace: FTP

Summary
~~~~~~~
Runtime Options
###############
================================================================= ===========================================================
:bro:id:`FTP::cmd_reply_code`: :bro:type:`set` :bro:attr:`&redef` Possible response codes for a wide variety of FTP commands.
================================================================= ===========================================================

Types
#####
=============================================== ====================================================================
:bro:type:`FTP::CmdArg`: :bro:type:`record`     
:bro:type:`FTP::PendingCmds`: :bro:type:`table` Structure for tracking pending commands in the event that the client
                                                sends a large number of commands before the server has a chance to 
                                                reply.
=============================================== ====================================================================


Detailed Interface
~~~~~~~~~~~~~~~~~~
Runtime Options
###############
.. bro:id:: FTP::cmd_reply_code

   :Type: :bro:type:`set` [:bro:type:`string`, :bro:type:`count`]
   :Attributes: :bro:attr:`&redef`
   :Default:

   ::

      {
         ["STRU", 501] ,
         ["SITE", 501] ,
         ["LIST", 530] ,
         ["PASS", 230] ,
         ["<init>", 421] ,
         ["STOR", 500] ,
         ["PASS", 202] ,
         ["ACCT", 500] ,
         ["RETR", 125] ,
         ["PWD", 550] ,
         ["NLST", 550] ,
         ["HELP", 502] ,
         ["LIST", 451] ,
         ["CWD", 530] ,
         ["HELP", 211] ,
         ["STOU", 551] ,
         ["STOU", 452] ,
         ["SYST", 215] ,
         ["NLST", 530] ,
         ["RNFR", 350] ,
         ["STOU", 451] ,
         ["MLST", 150] ,
         ["EPRT", 522] ,
         ["ABOR", 500] ,
         ["REST", 502] ,
         ["TYPE", 200] ,
         ["RETR", 110] ,
         ["RNTO", 530] ,
         ["APPE", 250] ,
         ["RETR", 451] ,
         ["NLST", 226] ,
         ["NLST", 502] ,
         ["APPE", 552] ,
         ["HELP", 501] ,
         ["STOR", 250] ,
         ["STOU", 500] ,
         ["STOR", 451] ,
         ["STOU", 553] ,
         ["APPE", 150] ,
         ["MKD", 502] ,
         ["RETR", 226] ,
         ["PWD", 257] ,
         ["MLST", 226] ,
         ["STRU", 421] ,
         ["MLSD", 550] ,
         ["STRU", 200] ,
         ["MLST", 500] ,
         ["APPE", 451] ,
         ["STOR", 452] ,
         ["SMNT", 501] ,
         ["ACCT", 230] ,
         ["DELE", 500] ,
         ["SYST", 502] ,
         ["ALLO", 504] ,
         ["STAT", 530] ,
         ["APPE", 532] ,
         ["CDUP", 501] ,
         ["SMNT", 421] ,
         ["APPE", 226] ,
         ["REST", 530] ,
         ["LIST", 150] ,
         ["SYST", 500] ,
         ["SYST", 530] ,
         ["RNFR", 500] ,
         ["STAT", 500] ,
         ["STRU", 504] ,
         ["STOR", 532] ,
         ["REST", 200] ,
         ["MODE", 530] ,
         ["DELE", 450] ,
         ["CWD", 502] ,
         ["REIN", 220] ,
         ["RNTO", 553] ,
         ["STOU", 421] ,
         ["RETR", 501] ,
         ["LIST", 500] ,
         ["RNFR", 421] ,
         ["MODE", 421] ,
         ["FEAT", 502] ,
         ["MACB", 200] ,
         ["RETR", 550] ,
         ["MODE", 504] ,
         ["APPE", 425] ,
         ["ALLO", 202] ,
         ["OPTS", 501] ,
         ["STOU", 226] ,
         ["STAT", 421] ,
         ["REIN", 502] ,
         ["STRU", 530] ,
         ["MLSD", 501] ,
         ["CWD", 421] ,
         ["NOOP", 500] ,
         ["MLSD", 250] ,
         ["PASS", 530] ,
         ["RNTO", 532] ,
         ["ALLO", 421] ,
         ["USER", 331] ,
         ["MKD", 530] ,
         ["STAT", 212] ,
         ["REIN", 120] ,
         ["RNTO", 503] ,
         ["STAT", 450] ,
         ["APPE", 500] ,
         ["APPE", 530] ,
         ["SITE", 214] ,
         ["FEAT", 211] ,
         ["STOU", 450] ,
         ["STOR", 425] ,
         ["RMD", 502] ,
         ["ABOR", 502] ,
         ["STOU", 426] ,
         ["STAT", 501] ,
         ["STOR", 552] ,
         ["RMD", 501] ,
         ["STOU", 110] ,
         ["MLST", 250] ,
         ["RNTO", 502] ,
         ["STOR", 150] ,
         ["ALLO", 200] ,
         ["MDTM", 501] ,
         ["PWD", 502] ,
         ["RNTO", 501] ,
         ["RETR", 450] ,
         ["MDTM", 213] ,
         ["RNTO", 250] ,
         ["DELE", 550] ,
         ["MKD", 421] ,
         ["RNTO", 421] ,
         ["APPE", 452] ,
         ["PORT", 200] ,
         ["STOU", 501] ,
         ["RNFR", 502] ,
         ["NLST", 425] ,
         ["REIN", 421] ,
         ["STOU", 532] ,
         ["RETR", 425] ,
         ["STAT", 502] ,
         ["HELP", 214] ,
         ["ABOR", 421] ,
         ["MKD", 501] ,
         ["CDUP", 200] ,
         ["STAT", 211] ,
         ["ALLO", 530] ,
         ["APPE", 553] ,
         ["CDUP", 250] ,
         ["PASS", 421] ,
         ["<init>", 120] ,
         ["EPSV", 501] ,
         ["TYPE", 504] ,
         ["HELP", 500] ,
         ["STOU", 550] ,
         ["SIZE", 550] ,
         ["DELE", 502] ,
         ["RNFR", 501] ,
         ["STAT", 213] ,
         ["USER", 421] ,
         ["CDUP", 500] ,
         ["PASV", 530] ,
         ["LIST", 550] ,
         ["REIN", 500] ,
         ["NOOP", 421] ,
         ["EPSV", 229] ,
         ["<missing>", 0] ,
         ["SYST", 421] ,
         ["APPE", 426] ,
         ["ACCT", 421] ,
         ["RMD", 550] ,
         ["MLSD", 226] ,
         ["USER", 230] ,
         ["PASS", 500] ,
         ["NLST", 125] ,
         ["NLST", 450] ,
         ["RMD", 530] ,
         ["STOR", 553] ,
         ["ACCT", 503] ,
         ["STOU", 425] ,
         ["MODE", 200] ,
         ["RMD", 250] ,
         ["PORT", 530] ,
         ["APPE", 501] ,
         ["HELP", 421] ,
         ["LPRT", 501] ,
         ["STOU", 250] ,
         ["STOU", 150] ,
         ["RMD", 421] ,
         ["HELP", 200] ,
         ["CLNT", 500] ,
         ["LIST", 125] ,
         ["CWD", 501] ,
         ["RNFR", 550] ,
         ["MLST", 550] ,
         ["CDUP", 502] ,
         ["SITE", 530] ,
         ["RETR", 421] ,
         ["RNTO", 500] ,
         ["RETR", 250] ,
         ["SITE", 202] ,
         ["STOR", 530] ,
         ["SMNT", 502] ,
         ["TYPE", 500] ,
         ["LIST", 426] ,
         ["APPE", 125] ,
         ["MDTM", 500] ,
         ["<init>", 0] ,
         ["LIST", 250] ,
         ["DELE", 250] ,
         ["MKD", 257] ,
         ["PASS", 332] ,
         ["PWD", 500] ,
         ["LIST", 226] ,
         ["FEAT", 500] ,
         ["NLST", 500] ,
         ["NLST", 501] ,
         ["EPRT", 500] ,
         ["DELE", 530] ,
         ["LIST", 502] ,
         ["APPE", 421] ,
         ["USER", 332] ,
         ["EPRT", 501] ,
         ["PORT", 500] ,
         ["SMNT", 250] ,
         ["STOU", 552] ,
         ["APPE", 550] ,
         ["STRU", 500] ,
         ["MLSD", 150] ,
         ["OPTS", 200] ,
         ["MODE", 501] ,
         ["NLST", 250] ,
         ["SIZE", 501] ,
         ["ACCT", 202] ,
         ["MKD", 500] ,
         ["SITE", 200] ,
         ["QUIT", 500] ,
         ["STOR", 426] ,
         ["LIST", 421] ,
         ["RETR", 150] ,
         ["MODE", 502] ,
         ["RMD", 500] ,
         ["NLST", 421] ,
         ["<init>", 220] ,
         ["PORT", 421] ,
         ["CWD", 250] ,
         ["RNFR", 450] ,
         ["STOR", 125] ,
         ["CLNT", 200] ,
         ["PASS", 501] ,
         ["PASV", 421] ,
         ["REST", 501] ,
         ["RNFR", 530] ,
         ["SMNT", 500] ,
         ["SMNT", 530] ,
         ["SITE", 502] ,
         ["APPE", 502] ,
         ["REST", 421] ,
         ["USER", 530] ,
         ["STOR", 550] ,
         ["MLST", 501] ,
         ["STOR", 551] ,
         ["OPTS", 451] ,
         ["SYST", 501] ,
         ["LPRT", 521] ,
         ["PORT", 501] ,
         ["NOOP", 200] ,
         ["APPE", 450] ,
         ["DELE", 501] ,
         ["ABOR", 225] ,
         ["PASV", 500] ,
         ["NLST", 150] ,
         ["CDUP", 530] ,
         ["PWD", 421] ,
         ["TYPE", 421] ,
         ["ABOR", 501] ,
         ["RETR", 500] ,
         ["ACCT", 530] ,
         ["STOR", 501] ,
         ["STOR", 226] ,
         ["RETR", 426] ,
         ["QUIT", 221] ,
         ["CDUP", 550] ,
         ["STOR", 450] ,
         ["NLST", 451] ,
         ["SITE", 500] ,
         ["SIZE", 213] ,
         ["STOR", 421] ,
         ["MACB", 550] ,
         ["PASV", 501] ,
         ["CWD", 500] ,
         ["ALLO", 501] ,
         ["PASV", 502] ,
         ["CDUP", 421] ,
         ["DELE", 421] ,
         ["SIZE", 500] ,
         ["PASV", 227] ,
         ["PWD", 501] ,
         ["REST", 350] ,
         ["NLST", 426] ,
         ["STOU", 530] ,
         ["USER", 501] ,
         ["USER", 500] ,
         ["PASS", 503] ,
         ["REST", 500] ,
         ["MLSD", 500] ,
         ["MACB", 500] ,
         ["SMNT", 550] ,
         ["RETR", 530] ,
         ["STOU", 125] ,
         ["TYPE", 501] ,
         ["CWD", 550] ,
         ["MKD", 550] ,
         ["STOR", 110] ,
         ["SMNT", 202] ,
         ["MDTM", 550] ,
         ["ABOR", 226] ,
         ["EPRT", 200] ,
         ["MODE", 500] ,
         ["ACCT", 501] ,
         ["EPSV", 500] ,
         ["QUIT", 0] ,
         ["ALLO", 500] ,
         ["LIST", 501] ,
         ["TYPE", 530] ,
         ["APPE", 551] ,
         ["LIST", 425] ,
         ["LPRT", 500] ,
         ["LIST", 450] 
      }

   Possible response codes for a wide variety of FTP commands.

Types
#####
.. bro:type:: FTP::CmdArg

   :Type: :bro:type:`record`

      ts: :bro:type:`time`
         Time when the command was sent.

      cmd: :bro:type:`string` :bro:attr:`&default` = ``"<unknown>"`` :bro:attr:`&optional`
         Command.

      arg: :bro:type:`string` :bro:attr:`&default` = ``""`` :bro:attr:`&optional`
         Argument for the command if one was given.

      seq: :bro:type:`count` :bro:attr:`&default` = ``0`` :bro:attr:`&optional`
         Counter to track how many commands have been executed.


.. bro:type:: FTP::PendingCmds

   :Type: :bro:type:`table` [:bro:type:`count`] of :bro:type:`FTP::CmdArg`

   Structure for tracking pending commands in the event that the client
   sends a large number of commands before the server has a chance to 
   reply.


